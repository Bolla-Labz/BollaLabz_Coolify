# Backend Environment Configuration for Coolify/VPS Deployment
# Last Modified: 2025-11-26
#
# DEPLOYMENT ARCHITECTURE (per BollaLabz_Truths):
# - VPS #1 (31.220.55.252): Coolify control plane
# - VPS #2 (93.127.197.222): Docker worker (runs this backend)
# - Production env vars are set in Coolify UI, not in files
#
# This file is a TEMPLATE. Copy to .env and update values.

# Application
NODE_ENV=production
PORT=3001

# Database (Coolify PostgreSQL - set in Coolify UI)
# In production, DATABASE_URL uses Docker service name 'postgres'
DATABASE_URL=postgresql://postgres:your_password@postgres:5432/bollalabz
DB_SSL=false
DB_POOL_MIN=2
DB_POOL_MAX=10

# Frontend Configuration (set your domain in Coolify UI)
# DNS should point to VPS #2 (93.127.197.222)
FRONTEND_URL=https://bollalabz.com
ALLOWED_ORIGINS=https://bollalabz.com

# JWT Authentication
# SECURITY CRITICAL: Generate strong random secrets with at least 32 characters!
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# IMPORTANT: JWT_SECRET and JWT_REFRESH_SECRET MUST be different!
JWT_SECRET=GENERATE_SECURE_64_CHAR_HEX_STRING_HERE_DO_NOT_USE_DEFAULT_XXXXXXXXXXXXXXXXX
JWT_REFRESH_SECRET=GENERATE_DIFFERENT_64_CHAR_HEX_STRING_HERE_DO_NOT_USE_DEFAULT_XXXXX
JWT_ACCESS_EXPIRY=15m
JWT_REFRESH_EXPIRY=7d

# API Key Authentication
# SECURITY: Generate a strong random API key (minimum 32 characters)
API_KEY=GENERATE_SECURE_API_KEY_HERE_MIN_32_CHARS_XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

# Session
SESSION_SECRET=GENERATE_SECURE_SESSION_SECRET_HERE_MIN_32_CHARS_XXXXXXXXXXXXXXXXXX
SESSION_TIMEOUT=86400000
SESSION_MAX_AGE=604800000

# Security
BCRYPT_ROUNDS=12  # OWASP recommends 12+ for bcrypt

# Development Mode Security Bypasses (MUST BE FALSE IN PRODUCTION!)
SKIP_CSRF=false
SKIP_TWILIO_SIGNATURE_VALIDATION=false

# Rate Limiting
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# Logging
LOG_LEVEL=info
LOG_FORMAT=json
LOG_FILE_PATH=./logs/app.log

# Sentry Error Monitoring
# Sign up at https://sentry.io/ and create a project
# Get your DSN from: Settings > Projects > [Your Project] > Client Keys
SENTRY_DSN=https://your-sentry-dsn@sentry.io/your-project-id

# Twilio (Optional - for SMS/Voice features)
TWILIO_ACCOUNT_SID=your_twilio_account_sid
TWILIO_AUTH_TOKEN=your_twilio_auth_token
TWILIO_PHONE_NUMBER=+1234567890
TWILIO_WEBHOOK_URL=http://localhost:3001/api/v1/webhooks/twilio
TWILIO_STATUS_CALLBACK_URL=http://localhost:3001/api/v1/webhooks/twilio/status

# Redis Cloud (External - per BollaLabz_Truths)
# Using Redis Cloud instead of local Redis container
# Get credentials from Redis Cloud console
REDIS_URL=redis://default:your_password@your-redis-cloud-host.redislabs.com:12345
REDIS_HOST=your-redis-cloud-host.redislabs.com
REDIS_PORT=12345
REDIS_PASSWORD=your_redis_cloud_password

# Anthropic API (Optional - for AI features)
# Sign up at https://console.anthropic.com/ and get your API key
# SECURITY: Never commit actual API keys to version control!
ANTHROPIC_API_KEY=sk-ant-YOUR_ACTUAL_KEY_HERE_NEVER_HARDCODE_IN_SOURCE
ANTHROPIC_MODEL=claude-sonnet-4-5-20250929
ANTHROPIC_MAX_TOKENS=4096

# Vapi Voice AI (Optional - for voice call features)
# Sign up at https://vapi.ai/ and get your API credentials
VAPI_API_KEY=your_vapi_api_key
VAPI_PHONE_NUMBER=your_vapi_phone_number
VAPI_ASSISTANT_ID=your_vapi_assistant_id
VAPI_WEBHOOK_URL=http://localhost:3001/api/v1/webhooks/vapi
VAPI_WEBHOOK_SECRET=your_webhook_secret

# Webhook Base
WEBHOOK_BASE_URL=http://localhost:3001/webhooks

# Feature Flags
FEATURE_VOICE_AGENTS=true
FEATURE_CALENDAR_INTEGRATION=true
FEATURE_AI_SEARCH=true
FEATURE_CONVERSATION_MEMORY=true
FEATURE_ANALYTICS_DASHBOARD=true
